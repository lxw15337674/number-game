# 数字找茬：RPG 进化版设计文档 (v3.1 - Energy Fever)

## 1. 核心机制 (Core Mechanics)

### 1.1 时间接力 (Time Relay)
游戏采用 **全局共享倒计时** 机制。
*   **初始时间**: 60秒。
*   **消耗**: 自然流逝 (-1s/s) + 错误惩罚 (-10s)。
*   **回复**: 通关奖励 (+10s)。
*   **失败**: 时间归零 -> 结算 -> 进度重置 (保留金币)。

### 1.2 能量爆发 (Energy & Fever)
通过连续正确的操作积攒能量，触发狂热状态。
*   **能量槽 (Energy Bar)**: 上限 100。
*   **获取**: 
    *   每成功通过一关: **+30**。
    *   每成功找到一个目标/配对: **+10**。
*   **流失**:
    *   自然衰减: **-2 / 秒** (给玩家思考空间)。
    *   错误惩罚: **-50** (大幅打断节奏)。
*   **Fever Mode**: 
    *   能量满 100 自动触发，持续 **8秒**。
    *   **效果**: 全局倒计时 **暂停** (Freezed)，期间获得的金币 **x2**。
    *   **视觉**: 界面泛金光，能量条燃烧特效。

### 1.3 局内成长 (Perks) - Roguelike 元素
每通过 **5** 个关卡（Boss 战后），触发 **“命运三选一”**。
*   **时间窃贼**: 每答对一次额外 +1秒。
*   **充能大师**: 能量获取速度 +50%。
*   **贪婪之手**: 关卡金币奖励 +50%。
*   **鹰眼**: 错误选项有 20% 概率直接消失。
*   **护盾**: 抵挡一次错误点击的惩罚 (每关重置)。

### 1.4 随机诅咒 (Curses) - 高难挑战
从第 **21** 关（无尽阶段）开始，每关有 30% 概率附加一个负面词缀。
*   **迷雾**: 只有鼠标附近的数字可见。
*   **乱流**: 数字每 3 秒随机互换位置。
*   **色盲**: 目标描述的颜色失效。
*   **奖励**: 带有诅咒的关卡，通关后时间/金币奖励 **翻倍**。

## 2. 关卡系统 (Level System)

### 2.1 混合结构
*   **Phase 1 (1-20)**: 教学与固定配置。
*   **Phase 2 (21+)**: 无尽算法生成 + 随机诅咒。

### 2.2 难度控制
*   维度：网格密度、规则复杂度、数值范围、诅咒概率。

## 3. 经济与养成 (Economy)

### 3.1 货币与存档
*   **金币**: 永久保留。
*   **存档**: 记录金币、最高关卡记录、已购买的永久升级。

### 3.2 永久升级 (Meta Upgrades)
在主菜单购买：
1.  **沙漏 (Max Time)**: 初始时间上限提升。
2.  **存钱罐 (Coin Gain)**: 金币获取率提升。
3.  **冷静 (Penalty Reduce)**: 错误惩罚时间减少。

## 4. 道具系统 (Items)

| 道具 | 价格 | 效果 |
| :--- | :--- | :--- |
| **复活币** | 200 | 死亡复活 +30s。 |
| **冲刺鞋** | 50 | 跳过前 5 关。 |
| **净化药水** | 30 | 清除当前关卡的诅咒。 |

## 5. UI 流程 (UI Flow)

1.  **Main Menu**: [开始] [强化] [商店]。
2.  **Game Loop**:
    *   **Game Scene**: 倒计时、能量条、Fever 特效。
    *   **Perk Selection**: 弹窗三选一 (每 5 关)。
    *   **Result**: 结算面板。

## 6. 技术实现路线 (Roadmap)

1.  **Phase 1: 数据基石**
    *   `GameData.ts`: 存档管理。
    *   `LevelManager.ts`: 关卡生成。
    *   `PerkManager.ts`: 随机 Perk 池。

2.  **Phase 2: 核心重构**
    *   `Game.ts`: 接入全局计时、能量槽逻辑、Fever 状态机。

3.  **Phase 3: 界面交互**
    *   制作 Perk UI。
    *   制作 Fever 视觉反馈。
